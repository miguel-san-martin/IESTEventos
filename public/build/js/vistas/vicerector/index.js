async function revisarEventos(){let e=baseurl+"Vicerector/revisareventos",a=await fetch(e);eventos=await a.json(),mostrarRevision(eventos)}function mostrarRevision(e){const a=document.querySelector("#celdas");for(;a.lastChild;)a.removeChild(a.lastChild);"0"!=Object.keys(e).length?e.forEach(e=>{e.fecha_final=obtenerFechaFormateada(e.fecha_final,!0),e.fecha_inicio=obtenerFechaFormateada(e.fecha_inicio,!0);const a=document.createElement("TR"),t=document.createElement("TD");t.setAttribute("data-label","Evento"),t.textContent=e.nombre,a.appendChild(t);const i=document.createElement("TD");i.setAttribute("data-label","Estatus"),i.textContent=e.estatus,a.appendChild(i);const s=document.createElement("TD");s.setAttribute("data-label","Lugar o plataforma"),e.virtual_link?s.textContent=e.virtual_plataforma:s.textContent=e.lugar_presencial,a.appendChild(s);const l=document.createElement("TD");l.setAttribute("data-label","Comentario AV"),l.textContent=e.comenario_av??"No ha realizado comentario alguno",a.appendChild(l);const o=document.createElement("TD");o.setAttribute("data-label","Mas detalles");const n=document.createElement("p");n.classList.add("centrar-texto","boton"),n.textContent="Revisar",n.classList.add("verde"),n.addEventListener("click",(function(){revisarEventos();const a=e.publico_divisiones.split(",");let t="",i="",s=!0;a.forEach((e,a)=>{switch(e){case"AD":i+="Administración y Dirección de Empresas, ";break;case"AR":i+="Arquitectura, ";break;case"CT":i+="Ciencias y Tecnologías, ";break;case"DG":i+="Diseño Gráfico, ";break;case"DE":i+="Derecho, ";break;case"DG":i+="Diseño Gráfico, ";break;case"EA":t+="Económico-Administrativas, ",s=!1;break;case"FC":i+="Finanzas y Contaduría Pública, ";break;case"FI":i+="Filosofía, ";break;case"FM":t+="Físico-Matemáticas, ";break;case"GA":i+="Gastronomía, ";break;case"HH":t+="Humanidades, ";break;case"ID":i+="Idiomas, ";break;case"II":i+="Ingeniería Industrial, ";break;case"IM":i+="Ingeniería Mecatrónica, ";break;case"IQ":i+="Ingeniería Química, ";break;case"IS":i+="Ingeniería en Sistemas y Negocios Digitales, ";break;case"MC":i+="Médico Cirujano, ";break;case"ME":i+="Mercadotecnia Estratégica, ";break;case"NI":i+="Negocios Internacionales, ";break;case"PS":i+="Psicología, ";break;case"QB":t+="Quimico-Biológica, ";break;case"preparatoria":t="Es para prepa:Todas las divisiones,";break;case"universidad":i="Es para universidad:Todas las divisiones,"}}),""!=t&&(s=!1);let l=!1;switch(""!=t&&""!=i&&(l=!0,s="lol"),e.publico_divisiones){case"preparatoria":t=t.slice(0,-1),e.publico_divisiones=t;break;case"universidad":i=i.slice(0,-1),e.publico_divisiones=i;break;case"general":e.publico_divisiones="El evento es para publico en General";break;case"ambos":e.publico_divisiones="El evento es para ambos niveles Preparatoria y Universidad: ";break;default:1==s&&(e.publico_divisiones="El evento es para universidad: "+i),s||(e.publico_divisiones="El evento es para preparatoria: "+t),l&&(e.publico_divisiones="El evento es para ambos niveles Preparatoria: "+t+"Universidad: "+i)}let o="";switch(e.publico_dirigido){case"general":o="Dirigido para publico en general";break;case"todos":o="Dirigido para todos los semestres";break;default:o="Es digirido para los siguientes semestres: ";const a=e.publico_dirigido.split(",").map(e=>parseInt(e)),t=["1° Semestre ","2° Semestre ","3° Semestre ","4° Semestre ","5° Semestre ","6° Semestre ","7° Semestre ","8° Semestre ","9° Semestre ","10° Semestre ","11° Semestre "];a.forEach(e=>{const a=t[e-1];o+=a})}e.publico_dirigido=o,retroalimentar_evento(e)})),o.appendChild(n),a.appendChild(o);document.querySelector("#celdas").appendChild(a)}):Swal.fire({title:"No hay eventos que revisar",showconfirmButton:"true",confirmButtonText:"Entiendo",showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"},customClass:{confirmButton:"sw_button verde"}})}async function retroalimentar_evento(e){const{value:a,isConfirmed:t}=await Swal.fire({html:`<div class="formulariogral"><div class="columnas"><fieldset id="general"><legend>Informacion General</legend><div class="campo"><label>Nombre del evento:</label><textarea style="text-transform: capitalize;" disabled>${e.nombre}</textarea></div><div class="campo"><label>Descripción del evento:</label><textarea style="text-transform: capitalize;" disabled>${e.descripcion}</textarea></div><div class="campo"><label>Fecha y Hora de inicio:</label><textarea style="text-transform: capitalize;" disabled>${e.fecha_inicio}</textarea></div><div class="campo"><label>Fecha y Hora de termino:</label><textarea style="text-transform: capitalize;" disabled>${e.fecha_final}</textarea></div><div class="campo"><label>Nombre del encargado del evento:</label><textarea style="text-transform: capitalize;" disabled>${e.nombre_responsable}</textarea></div><div class="campo"><label>Contacto del encargado del evento:</label><textarea style="text-transform: capitalize;" disabled>${e.contacto_responsable}</textarea></div><div class="campo"><label>Creador del evento:</label><input style="text-transform: capitalize;"value="${e.creador_nombre+" "+e.creador_apellidoP}"  disabled></div></fieldset><fieldset><legend>Publico</legend><div class="campo"><label>¿Para quien es el evento?:</label><textarea style="text-transform: capitalize;"disabled>${e.division}</textarea></div><div class="campo"><label>Semestres dirigido:</label><textarea style="text-transform: capitalize;"disabled>${e.publico_dirigido}</textarea></div><div class="campo"><label>Carreras Dirigidas</label><textarea disabled>${e.publico_divisiones}</textarea></div></fieldset></div><div class="columnas"><fieldset><legend>Acerca Modalidad</legend>`+("Presencial"===e.modalidad?`\n                    <div class="campo">\n                        <label>Modalidad:</label>\n                        <input id="modalidad" style="text-transform: capitalize;" value="${e.modalidad}" disabled>\n                    </div>\n                    <div class="campo">\n                        <label>Lugar:</label>\n                        <input style="text-transform: capitalize;" value="${e.lugar_presencial}" disabled>\n                    </div>\n                    <div class="campo">\n                        <label>Direccion:</label>\n                        <textarea disabled>${e.lugar_direccion}</textarea>\n                    </div>\n                    <div class="campo">\n                        <label>Cupo Maximo:</label>\n                        <input style="text-transform: capitalize;" value="${e.lugar_cupo_max??0}" disabled>\n                    </div>\n                `:`\n                    <div class="campo">\n                        <label>Modalidad:</label>\n                        <input id="modalidad" style="text-transform: capitalize;" value="${e.modalidad}" disabled>\n                    </div>\n                    <div class="campo">\n                        <label>Plataforma:</label>\n                        <input style="text-transform: capitalize;" value="${e.virtual_plataforma}" disabled>\n                    </div>\n                    <div class="campo">\n                        <label>Link:</label>\n                        <textarea disabled>${e.virtual_link}</textarea>\n                    </div>\n                    <div class="campo">\n                        <label>Informacion acerca:</label>\n                        <textarea disabled>${e.virtual_informacion}</textarea>\n                    </div>\n                `)+'</fieldset><fieldset><legend>Banners</legend><div class="campo flex-div-hz"><label>Banner Principal:</label>'+`<img class=""style="width: 60%"src="http://localhost/IESTEventos/build/img/eventos/${e.token}/${e.banner_principal}" alt=""></div><div class="campo flex-div-hz"><label>Banner Secundario:</label>`+`<img class=""style="width: 60%"src="http://localhost/IESTEventos/build/img/eventos/${e.token}/${e.banner_secundario}" alt=""></div></fieldset><fieldset><legend>RetroAlimentación</legend><div class="campo "><select id="estatuselect"onchange="onEstatusChange(this)"><option value="0"disabled selected>Estatus del evento</option><option value="2">Necesita correccion</option><option value="3">Aprobado</option></select></div><div id="retroalimentacion"class="campo ocultar"><textarea id="txtretro"column="10"style="witdh:100%" placeholder="Escribe tu retroalimentacion"></textarea></div></fieldset></div></div>`,showCancelButton:!0,showConfirmButton:!0,confirmButtonText:"Enviar",cancelButtonText:"Cancelar",customClass:{popup:"swalgrande"},preConfirm:()=>{const a=document.getElementById("txtretro").value,t=document.getElementById("estatuselect").value;switch(t){case"2":case"3":""==a&&Swal.showValidationMessage("Por favor, escriba su retroalimentacion");break;case"0":Swal.showValidationMessage("Por favor, seleccione el estatus del evento")}""!=a&&Swal.fire({title:"Cargando...",icon:"info",html:"Validando datos, por favor espere",allowOutsideClick:!1,customClass:{popup:"swalalert"},footer:'<p class="color-grisBajo">No cierre la pagina</p>',didOpen:()=>{mandarRetroalimentacion(a,t,e.id),Swal.showLoading()}})}})}function onEstatusChange(e){const a=document.querySelector("#retroalimentacion"),t=document.querySelector("#txtretro");switch(e.value){case"2":a.classList.remove("ocultar"),t.textContent="";break;case"3":a.classList.remove("ocultar"),t.textContent="Evento aprobado y sin errores. Esperando revisión del Administrador de Eventos."}}async function mandarRetroalimentacion(e,a,t){const i=new FormData;i.append("retroalimentacion",e),i.append("estatus",a),i.append("idevento",t);const s=baseurl+"ViceRector/mandarRetroalimentacion",l=await fetch(s,{method:"POST",body:i}),o=await l.json();o.success?Swal.fire({icon:"success",title:"RetroAlimentacion Enviada",allowOutsideClick:!1,text:""+o.message,showConfirmButton:!1,timer:2e3,customClass:{popup:"swalalert"},willClose:()=>{location.reload()}}):Swal.fire({icon:"error",title:"Intenta mas tarde",customClass:{popup:"swalalert"},allowOutsideClick:!1,text:""+o.message,showConfirmButton:!1,timer:2e3})}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("paso-1"),a=document.getElementById("paso-2");document.getElementById("btn_revisar").addEventListener("click",(function(){e.classList.add("ocultar"),a.classList.remove("ocultar"),Swal.fire({title:"Cargando...",icon:"info",allowOutsideClick:!1,customClass:{popup:"swalalert"},footer:'<p class="color-grisBajo">No cierre la pagina</p>',didOpen:()=>{Swal.showLoading(),revisarEventos(),setTimeout(()=>{Swal.close()},1e3)}})}))}));