const registro={nombre:"",apellidoP:"",apellidoM:"",correo:"",password:"",usuario:"",idiest:""};function formLogin(){document.querySelector("#btnLogin").addEventListener("click",(function(){let e=document.querySelector("#loginUser"),o=document.querySelector("#loginContraseÃ±a");""==!e.value&&""==!o.value?Swal.fire({title:"Un momento por favor",icon:"info",html:"Tratando de iniciar sesion",timerProgressBar:!0,allowOutsideClick:!1,customClass:{popup:"swalalert"},showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"},didOpen:()=>{Swal.showLoading(),login(e,o)}}):Swal.fire({icon:"error",title:"Por favor ingresa usuario o la password",showConfirmButton:!1,timer:2300,customClass:{popup:"swalalert"}})}))}async function login(e,o){const s=new FormData;s.append("password",o.value),s.append("username",e.value);const a=baseurl+"login",i=await fetch(a,{method:"POST",body:s}),r=await i.json();r.success?Swal.fire({title:""+r.message,allowOutsideClick:!1,icon:"success",timer:1200,customClass:{popup:"swalalert"},didOpen:()=>{Swal.showLoading()}}).then(e=>{e.dismiss===Swal.DismissReason.timer&&(window.location.href=baseurl+"usuariotipo")}):(o.value="",Swal.fire({icon:"error",title:""+r.message,showConfirmButton:!1,timer:1250,customClass:{popup:"swalalert"}}))}function validarInput(e,o,s){e.onchange=function(){let a=e.value.length;0==a?(e.classList.remove("exito"),e.classList.remove("error"),registro[""+s]=""):(e.classList.remove("exito"),e.classList.add("error"),registro[""+s]="",a>o&&(e.classList.remove("error"),e.classList.add("exito"),registro[""+s]=e.value))}}function validarCorreo(e,o){e.onchange=function(){e.value.endsWith("@iest.edu.mx")?(e.classList.add("exito"),registro[""+o]=e.value,registro.usuario=e.value.split("@")[0]):(e.classList.add("error"),e.classList.remove("exito"),registro[""+o]="",registro.usuario=""),0==e.value.length&&(e.classList.remove("exito"),e.classList.remove("error"),registro[""+o]="",registro.usuario="")}}async function registrar(){const e=new FormData;e.append("nombre",registro.nombre),e.append("apellidoP",registro.apellidoP),e.append("apellidoM",registro.apellidoM),e.append("password",registro.password),e.append("correo",registro.correo),e.append("username",registro.usuario),e.append("idiest",registro.idiest);const o=baseurl+"register",s=await fetch(o,{method:"POST",body:e}),a=await s.json();a.success?Swal.fire({icon:"success",title:"Cuenta Creada",allowOutsideClick:!1,text:"Confirmra tu identidad, te hemos mandado un correo",showConfirmButton:!1,timer:2e3,willClose:()=>{window.location.href="login"}}):Swal.fire({icon:"warning",title:"Algo salio mal...",text:""+a.message})}document.addEventListener("DOMContentLoaded",(function(){formLogin()}));